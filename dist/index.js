'use strict';module.exports={init:function init(_ref){var a=_ref.keystone,b=a.List.prototype.register;a.List.prototype.register=function(){var c=this,d=c.options.singleton;if(d){var e=c.key,f=e.split('').map(function(h){return h.toUpperCase()===h?' '+h:h}).join('').trim();c.add({singleton__name:{type:String,required:!0,default:f,hidden:!0}}),c.options.map=c.options.map||{},c.options.map.name=c.options.map.name||'singleton__name',c.options.nocreate=!0,c.options.nodelete=!0,c.options.label=c.options.label||f,b.apply(this);var g=a.list(e).model;g.count().lean().exec().then(function(h){return 0===h?(console.info('SINGLETON: Creating \''+e+'\'...'),g.create({})):Promise.resolve(void 0)}).catch(function(){console.error('SINGLETON: Could not create \''+e+'\'.')})}else b.apply(this)}}};